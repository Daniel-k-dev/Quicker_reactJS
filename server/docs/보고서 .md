## 수행한 작업 요약

수행한 작업은 **부분적인 클라이언트**, **전반적인 백엔드 서버 구축 및 배포**를 담당했습니다.

## 수행한 작업 목록

- 목록 중 `(*)`로 표기되어 있는 부분은 다른 인원과 함께 작업한 부분입니다.
- 목록의 항목을 클릭하시면 상세 설명 페이지로 이동합니다.

### 목록

> 작업 순서는 클라이언트, 서버, 인프라 각각 위에서 아래로 오래된 것부터 최근순으로 정렬하였습니다.

- [클라이언트](#클라이언트)
  - [디자인 (*)](#디자인)
  - [통신, 데이터 가공 처리, 렌더링](#통신-데이터-가공-처리-렌더링)
  - [TMAP API 초기 적용 (*)](#tmap-api-초기-적용)
  - [DAUM 주소 API 적용](#daum-주소-api-적용)
  - [QR코드](#qr코드)
  
- [서버](#서버)
  - [데이터 베이스 설계 (*)](#데이터-베이스-설계)
  - [ORM(Sequlize)을 이용한 데이터베이스 작업](#ormsequlize을-이용한-데이터베이스-작업)
  - [채팅](#채팅)
  - [슬랙봇 메시지](#슬랙봇-메시지)
  - [구조의 변경 + OOP](#구조의-변경)
  - [월간 거리당 평균 계산 처리](#월간-거리당-평균-계산-처리)
  - [커스텀 로거 설정](#커스텀-로거-설정)
  - [문자 발송](#문자-발송)

- [인프라](#인프라)
  - [MongoDB](#mongodb)
  - [클라우드 서버](#클라우드-서버)
  - [도메인, DNS 서버 설정](#도메인-dns-서버-설정)

## 작업한 내용에 대한 상세 설명

## 클라이언트
### 디자인 (*)

주로 화면에 너무 많은 색이 들어가거나 너무 생소한 유형의 컴포넌트 디자인이 들어가는 것을 방지했습니다.

예로 무채색과 특정 컬러감이 있는 색 1개 정도만 사용하도록 하거나 기존의 사용자들이 많이 접하는 유형의 컴포넌트 디자인으로 사용자 친화적인 디자인을 유지하기 위해 노력했습니다.

### 통신, 데이터 가공 처리, 렌더링

클라이언트에서 렌더링 시 필요한 데이터(데이터베이스와 블록체인의 데이터)의 요청, 결합, 필터링, 정렬, 변환 등을 작업했습니다.

클라이언트, 서버 둘 다 TypeScript를 사용하고 있었고 이 부분 덕분에 타 언어/프레임워크에 비하여 수월하게 통신을 할 수 있었습니다. 

### TMAP API 초기 적용 (*)

출발지, 도착지, 현재 위치에 대한 작업을 하였고 출발지와 도착지 간 거리, 소요 시간 등을 작업했습니다.

프로젝트의 초기 작업을 수행하였고 해당 API가 NPM에서는 공식적인 지원이 안되어 있는 상태이고 다른 라이브러리도 검증이 되어있지 않은 상태라서 손수 React에서 작업했습니다.

추후에 기능의 추가와 변동 사항 성능적인 측면 때문에 제가 아닌 다른 인원이 추가적으로 작업을 하였습니다.

### DAUM 주소 API 적용

사용자가 주소에 대한 정보를 입력하면 DAUM 주소 API에서 구체적인 주소 정보를 받고 주소 정보를 이용하여 지도에 좌표를 표시하는 작업을 하였습니다.

위의 TMAP API와 상황은 비슷했으나 이미 문제를 해결해서 이 부분은 쉽게 넘어갔습니다.

### QR코드

QR 코드를 생성, 스캔하여 수취인과 배송원 간의 상호작용이 가능하도록 작업했습니다.

## 서버

### 데이터 베이스 설계 (*)

주로 생길 수 있는 문제점, 정규화, 테이블 구조에 대한 검증 등의 작업을 수행했습니다.

팀원 모두가 설계에 참여하였습니다.

### ORM(Sequlize)을 이용한 데이터베이스 작업

> Java 진영의 JPA과 비슷한 JavaScript 진영의 ORM이라고 생각하시면 됩니다.

데이터베이스를 사용하는 작업은 ORM을 이용하여 처리했습니다.

### 채팅

Socket.IO를 이용하여 구현하였고 메시지는 MongoDB에 저장하는 방식을 사용하였습니다.

### 슬랙봇 메시지

배포된 서버에 에러가 발생하면 해당 에러의 정보(에러의 이름, 스택 트레이스, 발생 시각) 등을 팀이 사용하고 있는 슬랙 채널에 메시지를 발송하는 부분을 작업했습니다. 

### 레이어 설정, OOP

서버의 각 레이어를 나누어 정리하였고, 각종 데이터와 로직의 연결이 복잡한 부분을 하는 역할과 책임에 맞게 나누어 리팩토링하였습니다. 

#### 상세 설명

![Alt text](layer.drawio.svg)
> 서버의 구조를 도식화한 그림이며, 추상화한 그림이므로 누락되어 있는 부분이 있습니다.

레이어 설정은 비슷한 역할을 수행하는 레이어를 묶어 다른 레이어와 통신하는 방법을 사용하였고, OOP는 함수 여러 개를 묶은 모듈이 아닌 클래스 단위로 나누고 이를 계층 간 통신하는 방식으로 변경하였습니다. 

1학기 종강하고 여름방학 때 이 두 가지 작업을 했습니다.

#### 구조의 변경

각 레이어 간해야 할 일을 1가지만 수행하고 계층 간의 통신은 2단계 이상의 통신은 설정하지 않았습니다.

기존의 코드들은 함수의 집합으로 모듈화하여 import/export 하여 사용하였습니다. 그러다 보니 결합도가 강한 구조로 나오게 되고 이를 해결하기 위해 레이어를 분리하고 각 레이어를 대표하는 파일간 통신하도록 설정하였습니다.

#### OOP

역할과 책임에 맞게 나누어 클래스로 작업하였습니다.

기존 코드는 모듈단위로 관련 함수들을 묶어 사용하였습니다. 함수의 묶음이다 보니 데이터는 별도로 보관되거나 다른 스코프에 해당 되었고 이는 함수에 같은 파라미터의 증가로 이어졌습니다.

결국 해당 문제점을 해결하기 위해 OOP를 도입하게 되었고, 해결이 되었습니다.

### 월간 거리당 평균 계산 처리

매월 거래에 대한 거리당 금액의 평균을 계산하여 데이터 베이스에 저장하는 스케줄러를 작업했습니다.

### 커스텀 로거 설정

가시성이 좋은 로그를 위해 여러 가지 라이브러리를 조합하여 커스텀 로거를 작업했습니다.

PM2에서 기본적인 로그가 기록되고, 구동되는 운영체제 내부에 로그가 기록되지만 가시성이 좋지 않아 작업하게 되었습니다.

### 문자 발송

네이버 클라우드 플랫폼의 SMS API를 이용하여 문자 발송 서비스를 작업했습니다.

Twilio라는 외국의 메시지 전송 서비스를 이용하였으나, 비용, 해외 문자 발송의 특성상 발신에서 메시지를 받는 속도의 문제, 메시지에 Twilio Trial이 붙는 불편함이 있어 변경하게 되었습니다.

## 인프라

### MongoDB

채팅 메시지와 이미지의 처리를 위해 MongoDB를 사용하였습니다.
 
### 클라우드 서버
 
서버는 AWS를 사용하다 과금이 되어 GCP로 변경하였습니다.

### 도메인, DNS 서버 설정

도메인을 구입하여 HTTPS 적용으로 보안에 더 신경 썼습니다. cloudflare를 이용하여 DNS 설정을 했습니다.

## 개발 후기

장기간 작업하면서 변경사항이 많았기 때문에 그 부분에서 느끼는바가 많았습니다.

간략하게 제가 이번 프로젝트를 경험하면서 좋았던 점, 아쉬운 점, 개선할 점 순서대로 간략하게 작성하였습니다.

### 좋았던 점

#### 협업 + 장기 프로젝트

협업 + 장기 프로젝트이기 때문에 프로젝트를 진행하면서 부족한 부분이 나왔고, 배워야 할 것이 기하급수적으로 늘어나는 느낌을 받았습니다. 만약 짧은 주기의 협업 프로젝트라면 내가 무엇을 더 공부해야 하는지 알기 어러운 부분이라고 생각합니다.

#### 대화

팀원과 일정이 같아 점심시간과 쉬는 시간에 프로젝트에서 앞으로 처리해야 할 일, 예상되는 문제점, 여러 가지 방법에 대한 고민, 도입하면 괜찮을 정보에 관한 이야기 등을 할 수 있었습니다.

#### 새로운 것들에 대한 도입

ORM 적용, 구조 개선, OOP 도입 등 제가 원하는 것을 맘대로 추가해도 괜찮은 마지막 기회였다고 생각합니다. 

### 아쉬운 점 

#### 같은 파트의 협업

같은 파트의 협업이 있었으면 조금 더 얻을 무언가가 있지 않을까 싶은 생각이 듭니다.

각자 맡은 파트가 깔끔하게 나누어떨어지는 상태였기 때문에 협업 시 코드에 대한 의견의 충돌이 많지 않았습니다. 그렇기 때문에 나의 코드가 과연 올바른, 적어도 틀리지 않은 코드인가에 대한 고민이 있었습니다.

#### 부족한 부분에 대한 개선

아쉽게도 프로젝트가 끝나기까지 모든 문제점을 해결하지는 못했습니다.

#### 기술 도입의 근거

몇몇 기술은 도입할 때 확실한 근거가 없었습니다. 보통 새로 배운 것을 그때그때 적용하다 보니 생기는 문제였습니다.

프로젝트 설계 시 고민했던 기술에 대한 부분은 근거가 있었으나 계획에 없던 기능 추가 + 문서 업데이트 부재의 영향이 있었습니다.

#### 개발 문서의 업데이트

기존의 문서는 한글 파일로 만들어 유지 보수에 많이 취약했습니다. 이를 보완하기 위한 필요성을 느꼈으며, 유지 보수하기 쉽고 지속적인 업데이트를 해도 문서작업에 어려움이 크지 않은 문서 관리 툴이 필요함을 느꼈습니다.

### 개선할 점

개선할 점은 별도의 설명 없이 항목만 간단하게 나열했습니다.

- 배포 구조 개편
  - 자동 배포
  - 로드 밸런싱(PM2, Nginx)

- 서버 구조 개편
  - DB 설계 구조 개편
  - 내부 로직에 대한 리팩토링

- 프로젝트 문서화
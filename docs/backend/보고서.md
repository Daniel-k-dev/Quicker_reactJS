## 수행 내역

### ORM를 통한 DB 연동

#### 문제

이전 프로젝트에서 DB 작업을 드라이버로 수행했을 때 아래와 같은 문제점이 있었습니다.

- SQL Injection
- 개발자의 실수로 인한 쿼리 오류

#### 해결

드라이버와 ORM중 추가 학습과 비교적 성능저하가 있지만 드라이버를 사용했을 때 불필요한 작업을 안 해도 돼서 ORM을 선택했습니다. 다운로드, 이슈, 참고 자료를 기준으로 Sequelize를 선택했습니다.

### 서버 레이어 세분화

#### 문제

- 파일 하나에 미들웨어, 라우팅이 집중됨
- 각 컨트롤러 파일에 모든 로직이 집중됨
- 데이터베이스 계층 함수를 import로 사용하면서 변경에 취약해짐
- 데이터베이스 계층 함수를 유틸 함수 모듈처럼 작성하여 원하는 함수를 빠르게 찾을 수 없음

#### 해결

![alt text](images/layer.drawio.svg)

- 미들웨어, 라우터 파일 분리
- 컨트롤러, 서비스, 데이터베이스로 계층 분리
  - 컨트롤러의 하위 계층은 DI를 통해 변경에 취약한 문제를 해결
  - 클래스 빠른 접근이 가능하게 함

<!-- 미들웨어, 라우터, 컨트롤러, 서비스, 데이터베이스 계층으로 분리하고 계층의 컨트롤러의 하위 계층은 인스턴스를 생성해 DI를 통해 유지보수성을 확보하고 라우터에 인스턴스를 import하여 사용하도록 했습니다. -->

### 실시간 채팅

#### 문제

배송이 진행되는 동안 의뢰인과 배송원 간 연락 수단이 필요했습니다. 전화번호를 통해 연락할 수 있지만 개인정보 문제로 다른 방법을 찾아야 했습니다.

#### 해결

서비스에 Socket.IO를 이용한 실시간 채팅 기능을 추가했습니다.

### 월간 거리당 평균 의뢰금을 계산하는 스케쥴러

#### 문제

지역과 의뢰인에 따라 의뢰금이 달라 배송원은 적정 의뢰금을 알기 어려웠습니다.

#### 해결

매월 초 전월 의뢰 정보를 통해 거리당 평균 의뢰금을 계산해 배송원에게 제공했습니다. 이를 통해 배송원은 의뢰를 보고 적정 의뢰인지 판단할 수 있습니다.

### 수취인에게 배송 정보 제공

#### 문제

긴급하고 중요한 물품을 받는 수취인은 현재 배송 정보를 받고 싶어 합니다.

#### 해결

배송원이 의뢰를 수락하고 수취인에게 문자로 배송에 대한 정보를 제공하는 웹 페이지 URL을 전송합니다. 수취인은 해당 웹 페이지에서 현재 배송원 위치, 배송 완료/실패 물품 이미지, 배송 완료를 위한 QR코드를 확인할 수 있습니다.

<details>
  <summary><strong>접속 URL 문자 발송</strong></summary>

[접속 URL 문자 발송](https://github.com/user-attachments/assets/c77f2e0e-df44-4aee-b45c-1118bd8c47ec)

</details>

<details>
  <summary><strong>배송원 위치 조회</strong></summary>

#### 문제

수취인은 배송원의 현재 위치를 확인하고 싶어 합니다.

#### 해결

배송원이 의뢰를 수락하면 배송원의 위치가 주기적으로 기록됩니다. 이 위치정보는 수취인이 배송원의 위치를 확인할 때 사용됩니다.

https://github.com/user-attachments/assets/3fdd8274-9d69-48ae-beec-14629b16c9cb

</details>

<details>
  <summary><strong>QR코드</strong></summary>

#### 문제

퀵 서비스에 맡기는 물품은 긴급하거나 중요한 경우가 많습니다. 그래서 배송원과 수취인이 직접 대면하여 물품을 전달받는 상황을 주 사용 경로로 기획했습니다. 이에 따라 플랫폼에서 이러한 상황을 강제할 필요성이 있었습니다.

#### 해결

수취인에게 발송된 웹페이지 URL에 배송원이 배송 완료 처리를 위한 QR코드가 포함되어 있습니다. 수취인이 물품을 직접 확인 후 배송원이 배송 완료 처리를 할 수 있도록 구현했습니다.

https://github.com/user-attachments/assets/a209e2c2-4f9a-4c19-bb69-af7f10539b13

</details>

<details>
  <summary><strong>배송 성공/실패 이미지 전송</strong></summary>

#### 문제

배송원과 수취인이 대면하여 배송하지 못하는 경우 배송을 완료하는 방법이 필요했습니다.

#### 해결

배송 완료 사진을 업로드하고 수취인은 배송 완료된 사진을 통해 배송 완료 사실을 확인할 수 있습니다. 또는 배송 실패 시 배송 실패 이미지와 사유를 수취인에게 전달할 수 있도록 했습니다.

https://github.com/user-attachments/assets/7cede987-0ede-4c9d-a797-d40fc405730a

https://github.com/user-attachments/assets/6b2d209e-c674-4777-a9ca-153de5c0a3c5

</details>

### 슬랙 봇 메시지

#### 문제

배포된 원격 서버에 에러가 발생했을 때 즉각적인 피드백에 없어 서버의 상태를 인지하기 어렵고 서버 관리를 제가 하고 있어서 다른 팀원들은 상황 파악에 더 긴 시간이 걸렸습니다.

#### 해결

서버에 에러가 발생했을 때 팀원이 있는 슬랙 채널에 에러 정보(에러의 이름, 스택 트레이스, 발생 시각)를 공유하도록 했습니다.

### 커스텀 로거 설정

#### 문제

개발 환경에서 API 요청에 대한 검증을 위해 읽기 편한 요청 로그가 필요했습니다.

#### 해결

여러 라이브러리를 조합하여 API 테스트에 적합한 로거를 만들어 해결했습니다.

### 인프라

- 도메인, HTTPS 등의 네트워크 설정
- GCP를 이용한 배포 및 운영

### 기타

- 데이터베이스 설계
- 서버와 외부 API를 프론트에 연동

## 개발 후기

### 좋았던 점

#### 협업, 의사소통

이전 프로젝트의 팀원과 같이 이번 프로젝트를 진행하게 되었는데 이전 프로젝트에서 의사소통과 관련하여 규칙을 정한 부분이 프로젝트를 진행하는 데 있어 효율적인 의사소통이 되어 좋았습니다.

- 팀원 간 부끄러움을 내려놓고 조금이라도 이해가 안 되면 "나 이거 이해 못 했어"라고 표현
- 최대한 직설적으로 말하되 서로 이해함
  - 상대의 감정을 상하게 할 의도가 아님을 밝힘

프로젝트의 주제를 정할 때 팀원이 던진 아이디어를 모두 정리하고 검토하면서 최선을 찾고 의견이 맞지 않는 부분은 서로 최대한 납득시켰습니다. 그래도 해결이 되지 않는 부분은 담당 교수님께 조언을 구해 의견을 통일했습니다. 이러한 과정에서 합리적인 의사결정을 경험했습니다.

팀원 중 한 명과 일정이 같아 남는 시간에 앞으로 처리해야 할 일, 예상되는 문제점, 문제 해결 방법, 도입할 기술에 대한 이야기를 계속 나누었습니다. 혼자 생각하고 끝나는 게 아니라 다른 사람과 같은 문제에 대해 이야기 하면서 고민하다 보니 더 효율적이거나 좋은 방법이 나오게 되었습니다.

#### 얻은 것

프로젝트에 새로운 기술을 적용하다 보니 많이 헤매면서 어려운 부분도 있었지만, 프로젝트의 생존을 위해 빠르게 배울 수 있었습니다.

기획의 변경과 추가가 프로젝트 구조와 코드의 변경 원인이 되어 유지보수의 중요성에 대해 생각하게 되었습니다. 이러한 과정에서 기존에 이해하지 못한 부분을 몸으로 부딪히며 이해하게 되었습니다.

### 아쉬운 점

#### 협업

협업 과정에서 큰 문제가 발생하지 않아 협업에 대해 돌아볼 만한 큰 문제가 없었습니다.

제가 프론트와 백엔드 API 연동 작업을 수행했는데, 만약 프론트 인원이 연동 작업을 수행했다면 기획 당시 한글 파일로 작성된 개발 문서의 업데이트 원활하지 않아 문제가 발생했을 것 같습니다.

각 팀원의 담당 파트가 명확하게 떨어져서 같은 파트의 협업이 없었습니다. 만약 같은 파트에서 작업하는 팀원이 있었다면 같이 좋은 코드, 구조, 방법에 대해 고민하면서 더 좋은 결과가 나올 수 있었을 것 같습니다.

#### 충분한 고민

프로젝트 진행 중 기획의 변경과 추가로 인해 시간에 쫓겨 기술이나 방법에 대한 충분한 고민 없이 진행한 부분이 있습니다.
